import{r as l,p as r,q as o,w as c,B as e,P as s}from"./vendor.62143b15.js";const i=e("div",{class:"markdown-body"},[e("blockquote",null,[e("p",null,[s("Directus allows adding custom migration files that run whenever the "),e("code",null,"directus database migrate:*"),s(" commands are executed. All migrations must reside in the "),e("code",null,"extensions/migrations"),s(" folder.")])]),e("h2",{id:"file-name"},[s("File Name "),e("a",{class:"header-anchor",href:"#file-name"},"#")]),e("p",null,"The file name follows the following structure:"),e("pre",null,[e("code",null,`[identifier]-[name].js
`)]),e("p",null,"for example:"),e("pre",null,[e("code",null,`20201202A-my-custom-migration.js
`)]),e("h2",{id:"structure"},[s("Structure "),e("a",{class:"header-anchor",href:"#structure"},"#")]),e("p",null,[s("Migrations have to export an "),e("code",null,"up"),s(" and a "),e("code",null,"down"),s(" function. These functions get a "),e("a",{href:"http://knexjs.org",target:"_blank",rel:"noopener noreferrer"},"Knex"),s(" instance that can be used to do virtually whatever.")]),e("pre",null,[e("code",{class:"language-js"},[e("span",{class:"hljs-built_in"},"module"),s(`.exports = {
	`),e("span",{class:"hljs-keyword"},"async"),s(),e("span",{class:"hljs-function"},[e("span",{class:"hljs-title"},"up"),s("("),e("span",{class:"hljs-params"},"knex"),s(")")]),s(` {
		`),e("span",{class:"hljs-keyword"},"await"),s(" knex.schema.createTable("),e("span",{class:"hljs-string"},"'test'"),s(", "),e("span",{class:"hljs-function"},[s("("),e("span",{class:"hljs-params"},"table"),s(") =>")]),s(` {
			table.increments();
			table.string(`),e("span",{class:"hljs-string"},"'rijk'"),s(`);
		});
	},

	`),e("span",{class:"hljs-keyword"},"async"),s(),e("span",{class:"hljs-function"},[e("span",{class:"hljs-title"},"down"),s("("),e("span",{class:"hljs-params"},"knex"),s(")")]),s(` {
		`),e("span",{class:"hljs-keyword"},"await"),s(" knex.schema.dropTable("),e("span",{class:"hljs-string"},"'test'"),s(`);
	},
};
`)])]),e("div",{class:"danger hint"},[e("div",{class:"hint-title"},"Danger"),e("p",null,"Seeing that these migrations are a bit of a free-for-all, you can really harm your database. Please make sure you know what you\u2019re doing and backup your database before adding these migrations.")])],-1),m={setup(u,{expose:n}){const a={title:"Custom Migrations",modularExtension:!1};return n({frontmatter:a}),(d,p)=>{const t=l("DocsWrapper");return r(),o(t,{frontmatter:a},{default:c(()=>[i]),_:1})}}};export{m as default};
